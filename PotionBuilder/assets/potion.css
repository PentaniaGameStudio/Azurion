:root{
  /* === Palette de base === */
  --bg:#0f1221;
  --panel:#161a2f;
  --chip:#1f2444;
  --chipOn:#24305c;
  --border:#2a315c;
  --text:#e7eaff;
  --muted:#8d95c9;
  --accent:#7c9bff;
  --disabled:#5a639a;
  --good:#2ecc71; --warn:#f1c40f; --bad:#e74c3c;

  /* === Couleurs sémantiques (surfaces) === */
  --surface-0: #0b0e1a;                 /* fond profond */
  --surface-1: var(--panel);            /* carte */
  --surface-2: #111534;                 /* pied de carte / kpi */
  --surface-chip: var(--chip);          /* puces / boutons neutres */
  --surface-chipOn: var(--chipOn);      /* état actif */
  --surface-recipe: var(--chip);        /* groupe recette */
  --surface-recipe-row: #2d3766;        /* bande contenant les variantes */

  /* === Dégradés réutilisables === */
  --grad-app: linear-gradient(180deg,#0b0e1a,#0f1221 30%,#0b0e1a);
  --grad-card-heading: linear-gradient(180deg,#1a1f3b,#161a2f);
  --grad-center-window: linear-gradient(180deg,#161a2f,#141838);

  /* Boutons spéciaux */
  --grad-accent: linear-gradient(180deg,#2a3a7f,#263171);
  --grad-danger: linear-gradient(180deg,#5a2331,#4a1a26);

  /* Bouton “recette n” chaleureux */
  --recipe-btn-grad: linear-gradient(180deg,#f7c76a,#eaa23a);
  --recipe-btn-border: rgba(255,165,0,.35);
  --recipe-btn-text: #402300;

  /* Ombres */
  --shadow-1: 0 10px 22px rgba(0,0,0,.25);
  --shadow-2: 0 8px 18px rgba(0,0,0,.25);
  --shadow-inset-blue: inset 0 0 0 1px rgba(124,155,255,.35), 0 6px 16px rgba(0,0,0,.25);
  --shadow-recipe-btn: 0 2px 0 rgba(0,0,0,.15), inset 0 1px 0 rgba(255,255,255,.25);
}

/* ===== Reset ===== */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:var(--grad-app);
  color:var(--text);
  font:14px/1.5 system-ui,Segoe UI,Roboto,Helvetica,Arial;
}

/* ===== Header / Tabs ===== */
header{
  display:flex;gap:12px;align-items:center;justify-content:space-between;
  padding:16px 20px;border-bottom:1px solid var(--border);
  background:rgba(0,0,0,.25);backdrop-filter: blur(6px);
  position:sticky;top:0;z-index:10;
}
header h1{font-size:18px;margin:0;font-weight:700;letter-spacing:.3px}
header small{color:var(--muted)}
.btn-tab{
  border-radius:999px;padding:8px 12px;background:var(--surface-chip);
  border:1px solid var(--border);color:var(--text);cursor:pointer
}
.btn-tab:hover{border-color:var(--accent)}
.btn-tab.on{outline:2px solid #3a4b8f; background:var(--surface-chipOn)}

/* ===== Layout cartes ===== */
.wrap{display:grid;grid-template-columns:320px 1fr;gap:16px;padding:16px}
.card{
  background:var(--surface-1);border:1px solid var(--border);border-radius:14px;overflow:hidden;
  box-shadow:var(--shadow-1);
}
.card h2{
  margin:0;padding:12px 14px;border-bottom:1px solid var(--border);
  font-size:14px;color:#c9d2ff;letter-spacing:.4px;
  background:var(--grad-card-heading);
}
.card .content{padding:12px 14px}
.card .footer{padding:12px 14px;border-top:1px solid var(--border);background:var(--surface-2)}

.stack{display:flex;flex-direction:column;gap:10px}
.row{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
.tiny{font-size:12px}
.muted{color:var(--muted)}
.mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}

input[type=text],textarea,select{
  width:100%;background:#0e1123;color:var(--text);
  border:1px solid var(--border);border-radius:10px;padding:10px 12px
}
textarea{min-height:80px;resize:vertical}
button{
  background:var(--surface-chip);border:1px solid var(--border);color:var(--text);
  padding:8px 10px;border-radius:10px;cursor:pointer
}
button:hover{border-color:var(--accent)}
.btn-accent{background:var(--grad-accent);border-color:#2d3b86}
.btn-danger{background:var(--grad-danger);border-color:#7d2a3a}
.btn-ghost{background:transparent}

/* ===== Potion en cours ===== */
.active-bar{display:flex;flex-direction:column;align-items:center;gap:10px;padding:14px 20px 10px}
.center-window{
  display:flex;flex-direction:column;align-items:center;gap:10px;
  background:var(--grad-center-window);
  border:1px solid var(--border);border-radius:14px;
  padding:12px 16px;box-shadow:var(--shadow-1);
  max-width:960px;margin:0 auto;
}
.emoji-bubble{
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  text-align:center;gap:4px;max-width:100%;white-space:pre-line;
  padding:10px 14px;border-radius:999px;background:var(--surface-chipOn);
  border:1px solid #3a4b8f;box-shadow:var(--shadow-inset-blue);
  font-size:18px;
}

.totals{display:flex;gap:8px;flex-wrap:wrap;justify-content:center}
.pill{display:inline-flex;gap:8px;align-items:center;padding:6px 10px;background:#121633;border:1px solid var(--border);border-radius:999px}
.kpi{display:flex;gap:8px;align-items:center;background:var(--surface-2);border:1px dashed var(--border);padding:8px 10px;border-radius:12px}

/* Boutons KPIs façon Glyph */
.statBtn{
  font-weight:600;background:#121633;border:1px solid var(--border);color:var(--text);
  padding:6px 10px;border-radius:999px;cursor:pointer
}
.statBtn:hover{ border-color:#3a4b8f }
.statBtn.on{ background:#283477 }

/* Descriptions sous “Potion en cours” */
#cpTotals + #cpDetails { margin-top: 8px }
#cpDetails + #cpMath   { margin-top: 8px }
.callout,.desc-box{
  width:100%;background:#101433;border:1px solid var(--border);
  border-radius:12px;padding:10px 12px
}
.desc-line{font-size:15px;line-height:1.5}
.desc-line b{font-weight:700}
.desc-line i{color:var(--text);opacity:.92}

/* ===== Filtres / Ingrédients ===== */
.cats{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:8px}
.catBtn{padding:6px 10px;border-radius:999px;border:1px solid var(--border);background:#121633;color:#cbd3ff;cursor:pointer}
.catBtn.on{background:#283477}

.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:10px}
.ing-card{
  display:flex;flex-direction:column;gap:6px;padding:10px;border-radius:12px;
  background:var(--surface-chip);border:1px solid var(--border);
}
.ing-card.on{background:#2d3766;border-color:#7c9bff;box-shadow:0 0 0 2px rgba(124,155,255,.45)}
.ing-top{display:flex;align-items:center;justify-content:space-between;gap:8px}
.ing-name{font-weight:700}
/* Emoji de catégorie à droite (plus gros sans casser la ligne) */
.ing-cat{font-size:26px;line-height:1;display:flex;align-items:center;color:#cbd3ff}
.ing-desc{color:var(--muted);font-size:12px}
.ing-origins{color:#cbd3ff;font-size:12px}
.ing-diff{display:inline-flex;align-items:center;gap:6px}
.ing-card[aria-disabled="true"]{opacity:.55;filter:saturate(.7)}
.ing-card[aria-disabled="true"] *{pointer-events:none}

/* ===== Dropdown Origines ===== */
#originDropdown{
  position:fixed;z-index:9999;display:none;
  min-width:260px;max-width:min(420px,calc(100vw - 16px));
  max-height:min(380px,calc(100vh - 16px));overflow:auto;
  background:#121633;border:1px solid var(--border);border-radius:14px;
  box-shadow:0 12px 28px rgba(0,0,0,.4);padding:10px;will-change:top,left;
}
#originDropdown.open{display:block}
.tree{display:flex;flex-direction:column;gap:4px}
.tree .node{display:flex;align-items:center;gap:6px}
.tree .children{margin-left:16px;border-left:1px dashed var(--border);padding-left:10px}

/* ===== Vues / Utils ===== */
.views{display:block}
.hidden{display:none !important}
.center-actions{display:flex;gap:10px;align-items:center;justify-content:center;flex-wrap:wrap}
hr{border:0;border-top:1px solid var(--border);opacity:.5}

/* ===== Recettes (groupes + variantes) ===== */

/* Liste de groupes : centrée, en wrap, items shrink-to-fit */
.recipe-list{
  display:flex;flex-wrap:wrap;gap:20px;justify-content:center;align-items:flex-start;
}

/* Boîte d’une recette : largeur auto (contenu), centrée */
.recipe-group{
  display:inline-flex;flex-direction:column;align-items:center;gap:10px;
  background:var(--surface-recipe);border:1px solid var(--border);border-radius:18px;
  padding:14px 16px;box-shadow:var(--shadow-2);
  width:fit-content;max-width:min(90vw,560px);
}

.recipe-group-title{
  text-align:center;font-weight:700;font-size:20px;margin:0;color:#c9d2ff;white-space:nowrap;
}

.recipe-variants{
  display:flex;gap:12px;flex-wrap:wrap;justify-content:center;
  padding:8px;
  border-radius:12px;
}

/* Petits boutons “recette n” (chauds) */
.recipe-variant-btn{
  display:inline-flex;align-items:center;justify-content:center;white-space:nowrap;
  padding:10px 14px;border-radius:14px;border:1px solid var(--recipe-btn-border);
  background:var(--recipe-btn-grad);color:var(--recipe-btn-text);font-weight:700;cursor:pointer;
  box-shadow:var(--shadow-recipe-btn);
}
.recipe-variant-btn:hover{
  filter:brightness(1.05);
  box-shadow:0 0 0 2px rgba(255,200,80,.25) inset, 0 2px 0 rgba(0,0,0,.15);
}
.recipe-variant-btn:active{ transform: translateY(1px) }
